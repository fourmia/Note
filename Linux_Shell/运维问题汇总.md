### 常见问题汇总

1. 批量结束包含某程序名的驻留内存的进程
```sh
ps -ef|grep xxx|grep -v grep|awk '{print "kill -9 "$2}'| sh    # xxx为需要终止的进程名称， 建议先使用 ps -ef | grep xxx 查看输出进程是否为自己需要结束的进程

ps -ef|grep hello.py|grep -v grep|awk '{print "kill -9 "$2}'| sh  # 此命令作用则为批量结束主存中所有正运行的包含hello.py字串的进程

```

2. 文件锁设定

>在进行文件锁设定时，为防止异常原因导致进程一直被阻塞，而使得文件锁一直被占用，导致定时任务中该任务后续程序无法正常执行，需设定超时时间，使得异常阻塞的进程在运行指定时间后结束，从而释放文件锁,以如下

```sh
0 */30 * * * flock -xn ./xxx.lock -c 'timeout 3h python xxx' # 若该程序3h仍然未运行结束，则认为其存在错误，使其结束运行。
```

3. 批量杀死非运行态容器

> 在docker中创建新容器，提示名称占用 **The container name “/XXX“ is already in use by container**，使用`docker container ls`发现此容器ID并不存在，而使用`docker ps -a`,发现其为非运行态，即状态为"Exited"，为了防止非运行态容器（此处特指Exited状态）导致新容器创建名称失败，对其执行批量杀死操作, **建议将其保存为shell脚本，以方便使用**。
```sh
#!/bin/bash
exited=$(docker ps -a | grep Exited* | cut -d " " -f 1)   # 提起非运行态id
for cid in $exited
do
    # echo $cid
    `docker rm $cid`
done
# echo `docker ps -a | grep Exited*`
```